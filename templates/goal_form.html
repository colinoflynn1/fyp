{% extends "base.html" %}
{% block content %}
<section class="page-header">
  <div>
    <h1>{{ "Create savings goal" if mode == "create" else "Edit savings goal" }}</h1>
    <p>Set a target amount, deadline, and how often you plan to save.</p>
  </div>
  <a class="link-muted" href="{{ url_for('goals_dashboard') }}">← Back to goals</a>
</section>

<form method="post" class="card">
  <div>
    <label for="goal_name">Goal name</label>
    <input
      type="text"
      id="goal_name"
      name="goal_name"
      value="{{ goal.goal_name if goal else '' }}"
      placeholder="e.g. Emergency fund"
      required
    >
  </div>

  <div>
    <label for="target_amount">Target amount (€)</label>
    <input
      type="number"
      id="target_amount"
      name="target_amount"
      min="0"
      step="10.00"
      value="{{ goal.target_amount if goal else '' }}"
      required
    >
  </div>

  <div>
    <label for="target_date">Target date</label>
    {% set date_value = "" %}
    {% if goal and goal.target_date %}
      {% if goal.target_date.__class__.__name__ == 'date' %}
        {% set date_value = goal.target_date.isoformat() %}
      {% elif goal.target_date.__class__.__name__ == 'datetime' %}
        {% set date_value = goal.target_date.date().isoformat() %}
      {% else %}
        {% set date_value = goal.target_date %}
      {% endif %}
    {% endif %}
    <input
      type="date"
      id="target_date"
      name="target_date"
      value="{{ date_value }}"
      required
    >
  </div>

  <div>
    <label for="frequency">Saving frequency</label>
    <select id="frequency" name="frequency" required>
      <option value="" disabled {% if not goal or not goal.frequency %}selected{% endif %}>Select a frequency</option>
      {% for freq in freq_options %}
        <option value="{{ freq }}" {% if goal and goal.frequency == freq %}selected{% endif %}>
          {{ freq|title }}
        </option>
      {% endfor %}
    </select>
  </div>

  {% if mode == "create" %}
    <div>
      <label for="initial_deposit">Initial lump sum (€)</label>
      <input
        type="number"
        id="initial_deposit"
        name="initial_deposit"
        min="0"
        step="10.00"
        value="{{ goal.initial_deposit if goal else '' }}"
        placeholder="Enter 0 if none"
      >
    </div>
  {% endif %}

  <button type="submit">
    {{ "Create goal" if mode == "create" else "Save changes" }}
  </button>
</form>
{% endblock %}

